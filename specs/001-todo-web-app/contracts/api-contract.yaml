# API Contract: Todo Full-Stack Web Application

**Feature**: Todo Full-Stack Web Application
**Date**: 2026-01-23
**Version**: 1.0

## Overview

This document defines the REST API contract for the Todo Full-Stack Web Application, specifying endpoints, request/response formats, authentication requirements, and error handling.

## Base URL

```
https://api.example.com/v1
```

## Authentication

All protected endpoints require JWT authentication via the Authorization header:

```
Authorization: Bearer <jwt_token>
```

- JWT tokens are obtained via Better Auth login/signup endpoints
- Invalid/expired tokens return 401 Unauthorized
- All user data access is restricted to the authenticated user's data only

## Common Headers

### Request Headers
- `Authorization: Bearer <token>` (for protected endpoints)
- `Content-Type: application/json` (for POST/PUT requests)

### Response Headers
- `Content-Type: application/json`
- `X-Request-ID: <uuid>` (for request tracing)

## Common Response Format

### Success Responses
```json
{
  "success": true,
  "data": { /* response data */ },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

### Error Responses
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Human-readable error message",
    "details": { /* optional error details */ }
  },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

## Endpoints

### Authentication Endpoints

#### POST /auth/register
Register a new user account

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "secure_password_123",
  "name": "John Doe"
}
```

**Response (201 Created):**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "name": "John Doe"
    },
    "token": "jwt_token"
  },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

**Error Responses:**
- 400: Invalid input (validation errors)
- 409: Email already exists

#### POST /auth/login
Authenticate user and return JWT token

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "secure_password_123"
}
```

**Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "name": "John Doe"
    },
    "token": "jwt_token"
  },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

**Error Responses:**
- 400: Invalid input
- 401: Invalid credentials

### Task Management Endpoints

#### GET /tasks
Retrieve authenticated user's tasks

**Query Parameters:**
- `limit`: Number of tasks to return (default: 50, max: 100)
- `offset`: Number of tasks to skip (default: 0)
- `completed`: Filter by completion status ("true", "false", or omit for all)

**Headers Required:**
- `Authorization: Bearer <token>`

**Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "tasks": [
      {
        "id": "uuid",
        "title": "Task title",
        "description": "Task description",
        "completed": false,
        "user_id": "user_uuid",
        "created_at": "2026-01-23T10:00:00Z",
        "updated_at": "2026-01-23T10:00:00Z",
        "due_date": "2026-01-30T17:00:00Z"
      }
    ],
    "pagination": {
      "total": 15,
      "limit": 50,
      "offset": 0
    }
  },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

**Error Responses:**
- 401: Unauthorized (invalid/expired token)

#### POST /tasks
Create a new task for the authenticated user

**Headers Required:**
- `Authorization: Bearer <token>`

**Request Body:**
```json
{
  "title": "New task title",
  "description": "Task description (optional)",
  "due_date": "2026-01-30T17:00:00Z" (optional)
}
```

**Response (201 Created):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "title": "New task title",
    "description": "Task description (optional)",
    "completed": false,
    "user_id": "authenticated_user_uuid",
    "created_at": "2026-01-23T10:00:00Z",
    "updated_at": "2026-01-23T10:00:00Z",
    "due_date": "2026-01-30T17:00:00Z"
  },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

**Error Responses:**
- 400: Invalid input (validation errors)
- 401: Unauthorized

#### GET /tasks/{task_id}
Retrieve a specific task by ID

**Path Parameter:**
- `task_id`: UUID of the task to retrieve

**Headers Required:**
- `Authorization: Bearer <token>`

**Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "title": "Task title",
    "description": "Task description",
    "completed": false,
    "user_id": "user_uuid",
    "created_at": "2026-01-23T10:00:00Z",
    "updated_at": "2026-01-23T10:00:00Z",
    "due_date": "2026-01-30T17:00:00Z"
  },
  "timestamp": "2026-01-23T10:00:00Z"
}
```

**Error Responses:**
- 401: Unauthorized
- 403: Forbidden (attempting to access another user's task)
- 404: Task not found

#### PUT /tasks/{task_id}
Update an existing task

**Path Parameter:**
- `task_id`: UUID of the task to update

**Headers Required:**
- `Authorization: Bearer <token>`

**Request Body:**
```json
{
  "title": "Updated task title",
  "description": "Updated description",
  "completed": true,
  "due_date": "2026-01-30T17:00:00Z"
}
```

**Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "title": "Updated task title",
    "description": "Updated description",
    "completed": true,
    "user_id": "user_uuid",
    "created_at": "2026-01-23T10:00:00Z",
    "updated_at": "2026-01-23T11:00:00Z",
    "due_date": "2026-01-30T17:00:00Z"
  },
  "timestamp": "2026-01-23T11:00:00Z"
}
```

**Error Responses:**
- 400: Invalid input
- 401: Unauthorized
- 403: Forbidden (attempting to access another user's task)
- 404: Task not found

#### PATCH /tasks/{task_id}/complete
Toggle task completion status

**Path Parameter:**
- `task_id`: UUID of the task to update

**Headers Required:**
- `Authorization: Bearer <token>`

**Request Body:**
```json
{
  "completed": true
}
```

**Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "title": "Task title",
    "description": "Task description",
    "completed": true,
    "user_id": "user_uuid",
    "created_at": "2026-01-23T10:00:00Z",
    "updated_at": "2026-01-23T11:00:00Z",
    "due_date": "2026-01-30T17:00:00Z"
  },
  "timestamp": "2026-01-23T11:00:00Z"
}
```

**Error Responses:**
- 400: Invalid input
- 401: Unauthorized
- 403: Forbidden (attempting to access another user's task)
- 404: Task not found

#### DELETE /tasks/{task_id}
Delete a specific task

**Path Parameter:**
- `task_id`: UUID of the task to delete

**Headers Required:**
- `Authorization: Bearer <token>`

**Response (204 No Content):**
```
(Empty response body)
```

**Error Responses:**
- 401: Unauthorized
- 403: Forbidden (attempting to access another user's task)
- 404: Task not found

## Error Codes

| Code | HTTP Status | Description |
|------|-------------|-------------|
| AUTH_001 | 401 | Invalid or expired JWT token |
| AUTH_002 | 401 | Invalid credentials |
| AUTH_003 | 409 | Email already exists |
| VALIDATION_001 | 400 | Invalid input format |
| VALIDATION_002 | 400 | Missing required field |
| RESOURCE_001 | 404 | Resource not found |
| RESOURCE_002 | 403 | Access denied (cross-user access attempt) |
| SERVER_001 | 500 | Internal server error |

## Security Requirements

1. All endpoints except authentication require valid JWT tokens
2. User data isolation: Users can only access their own tasks
3. Input validation: All user inputs must be validated
4. Rate limiting: Authentication endpoints should be rate-limited
5. Logging: All API requests should be logged for security monitoring

## Performance Requirements

1. API response time: <2 seconds for 95% of requests
2. Pagination: Default limit of 50 items per request
3. Concurrency: Support at least 100 concurrent users
4. Database queries: All queries must be indexed appropriately

## Versioning

- API version is included in the URL path (v1)
- Breaking changes will result in a new version (v2)
- Non-breaking additions are allowed within the same version